import{K as A}from"./index-hVQJA9mG.js";let b,p=null;function U(){return(p===null||p.byteLength===0)&&(p=new Uint8Array(b.memory.buffer)),p}let E=0;function M(t,r){const e=r(t.length*1,1)>>>0;return U().set(t,e/1),E=t.length,e}let x=null;function L(){return(x===null||x.buffer.detached===!0||x.buffer.detached===void 0&&x.buffer!==b.memory.buffer)&&(x=new DataView(b.memory.buffer)),x}function W(t,r){return t=t>>>0,U().subarray(t/1,t/1+r)}function j(t){try{const a=b.__wbindgen_add_to_stack_pointer(-16),s=M(t,b.__wbindgen_export_0),f=E;b.sha2(a,s,f);var r=L().getInt32(a+4*0,!0),e=L().getInt32(a+4*1,!0),n=W(r,e).slice();return b.__wbindgen_export_1(r,e*1,1),n}finally{b.__wbindgen_add_to_stack_pointer(16)}}async function H(t,r){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,r)}catch(n){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const e=await t.arrayBuffer();return await WebAssembly.instantiate(e,r)}else{const e=await WebAssembly.instantiate(t,r);return e instanceof WebAssembly.Instance?{instance:e,module:t}:e}}function C(){const t={};return t.wbg={},t}function D(t,r){return b=t.exports,B.__wbindgen_wasm_module=r,x=null,p=null,b}async function B(t){if(b!==void 0)return b;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("/wasm-bench/assets/sha_was_bg-8ZiwjNaJ.wasm",import.meta.url));const r=C();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:e,module:n}=await H(await t,r);return D(e,n)}function N(t,r,e,n){function a(s){return s instanceof e?s:new e(function(f){f(s)})}return new(e||(e=Promise))(function(s,f){function y(c){try{i(n.next(c))}catch(d){f(d)}}function o(c){try{i(n.throw(c))}catch(d){f(d)}}function i(c){c.done?s(c.value):a(c.value).then(y,o)}i((n=n.apply(t,r||[])).next())})}function z(t,r){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,a,s,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=y(0),f.throw=y(1),f.return=y(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(i){return function(c){return o([i,c])}}function o(i){if(n)throw new TypeError("Generator is already executing.");for(;f&&(f=0,i[0]&&(e=0)),e;)try{if(n=1,a&&(s=i[0]&2?a.return:i[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,i[1])).done)return s;switch(a=0,s&&(i=[i[0]&2,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return e.label++,{value:i[1],done:!1};case 5:e.label++,a=i[1],i=[0];continue;case 7:i=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(i[0]===6||i[0]===2)){e=0;continue}if(i[0]===3&&(!s||i[1]>s[0]&&i[1]<s[3])){e.label=i[1];break}if(i[0]===6&&e.label<s[1]){e.label=s[1],s=i;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(i);break}s[2]&&e.ops.pop(),e.trys.pop();continue}i=r.call(t,e)}catch(c){i=[6,c],a=0}finally{n=s=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}var h=64,$=32,G=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),F=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],J=Math.pow(2,53)-1,v=function(){function t(){this.state=Int32Array.from(F),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return t.prototype.update=function(r){if(this.finished)throw new Error("Attempted to update an already finished hash.");var e=0,n=r.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>J)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=r[e++],n--,this.bufferLength===h&&(this.hashBuffer(),this.bufferLength=0)},t.prototype.digest=function(){if(!this.finished){var r=this.bytesHashed*8,e=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(e.setUint8(this.bufferLength++,128),n%h>=h-8){for(var a=this.bufferLength;a<h;a++)e.setUint8(a,0);this.hashBuffer(),this.bufferLength=0}for(var a=this.bufferLength;a<h-8;a++)e.setUint8(a,0);e.setUint32(h-8,Math.floor(r/4294967296),!0),e.setUint32(h-4,r),this.hashBuffer(),this.finished=!0}for(var s=new Uint8Array($),a=0;a<8;a++)s[a*4]=this.state[a]>>>24&255,s[a*4+1]=this.state[a]>>>16&255,s[a*4+2]=this.state[a]>>>8&255,s[a*4+3]=this.state[a]>>>0&255;return s},t.prototype.hashBuffer=function(){for(var r=this,e=r.buffer,n=r.state,a=n[0],s=n[1],f=n[2],y=n[3],o=n[4],i=n[5],c=n[6],d=n[7],u=0;u<h;u++){if(u<16)this.temp[u]=(e[u*4]&255)<<24|(e[u*4+1]&255)<<16|(e[u*4+2]&255)<<8|e[u*4+3]&255;else{var l=this.temp[u-2],k=(l>>>17|l<<15)^(l>>>19|l<<13)^l>>>10;l=this.temp[u-15];var O=(l>>>7|l<<25)^(l>>>18|l<<14)^l>>>3;this.temp[u]=(k+this.temp[u-7]|0)+(O+this.temp[u-16]|0)}var _=(((o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7))+(o&i^~o&c)|0)+(d+(G[u]+this.temp[u]|0)|0)|0,T=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&s^a&f^s&f)|0;d=c,c=i,i=o,o=y+_|0,y=f,f=s,s=a,a=_+T|0}n[0]+=a,n[1]+=s,n[2]+=f,n[3]+=y,n[4]+=o,n[5]+=i,n[6]+=c,n[7]+=d},t}();const K=t=>new TextEncoder().encode(t);var V=typeof Buffer<"u"&&Buffer.from?function(t){return Buffer.from(t,"utf8")}:K;function R(t){return t instanceof Uint8Array?t:typeof t=="string"?V(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}function q(t){return typeof t=="string"?t.length===0:t.byteLength===0}var Y=function(){function t(r){this.secret=r,this.hash=new v,this.reset()}return t.prototype.update=function(r){if(!(q(r)||this.error))try{this.hash.update(R(r))}catch(e){this.error=e}},t.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},t.prototype.digest=function(){return N(this,void 0,void 0,function(){return z(this,function(r){return[2,this.digestSync()]})})},t.prototype.reset=function(){if(this.hash=new v,this.secret){this.outer=new v;var r=Z(this.secret),e=new Uint8Array(h);e.set(r);for(var n=0;n<h;n++)r[n]^=54,e[n]^=92;this.hash.update(r),this.outer.update(e);for(var n=0;n<r.byteLength;n++)r[n]=0}},t}();function Z(t){var r=R(t);if(r.byteLength>h){var e=new v;e.update(r),r=e.digest()}var n=new Uint8Array(h);return n.set(r),n}await B();function X(t){const r=new Uint8Array(t),e=65536;for(let n=0;n<t;n+=e)r.set(crypto.getRandomValues(new Uint8Array(Math.min(e,t-n))),n);return r}const P=8,Q=128*1024*1024,I=[];for(let t=P;t<=Q;t*=2)I.push(t);const w=new A({iterations:10,time:1e4,warmupIterations:5,name:"SHA-256"});w.concurrency=null;w.threshold=1;const g=new A({iterations:10,time:1e4,warmupIterations:5,name:"WebCrypto"});g.concurrency=null;g.threshold=1;const m=new A({iterations:10,time:1e4,warmupIterations:5,name:"JS"});m.concurrency=null;m.threshold=1;console.log("Setting up SHA-256 benchmarks...");for(const t of I){const r=X(t);w.add(`${t}`,()=>{j(r)}),g.add(`${t}`,async()=>{await crypto.subtle.digest("SHA-256",r)}),m.add(`${t}`,async()=>{const e=new Y;e.update(r),await e.digest()})}function S(t,r){const e=t.map(({name:s,result:f})=>f?{name:s,suite:r,latency:f.latency?.samples?.length||0,throughput:f.throughput?.samples?.length||0,hz:f.throughput?.mean||0,mean:f.latency?.mean||0,sd:f.latency?.sd||0,min:f.latency?.min||0,max:f.latency?.max||0,p99:f.latency?.p99||0,p995:f.latency?.p995||0,p75:f.latency?.p75||0}:{name:s,suite:r,error:"No result"}),n=JSON.stringify(e,null,2),a=document.createElement("a");a.href=URL.createObjectURL(new Blob([n],{type:"application/json"})),a.download=`sha-256-benchmark-results-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,a.textContent="Download SHA-256 Results",document.body.appendChild(a)}console.log("Running SHA-256 benchmarks...");S(await w.run(),"wasm-sha");console.table(w.table());S(await g.run(),"web-crypto");console.table(g.table());S(await m.run(),"js");console.table(m.table());console.log("Benchmarking completed!");
